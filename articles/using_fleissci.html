<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using the quadagree package • quadagree</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the quadagree package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">quadagree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/web_only/benchmarks_aggr.html">Short benchmark of Fleiss' kappa and Brennan-Prediger</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/benchmarks_long.html">Benchmark of Fleiss' kappa, Cohen's kappa, and the Brennan-Prediger coefficient</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/consistency.html">Consistency with missing ratings</a></li>
    <li><a class="dropdown-item" href="../articles/using_fleissci.html">Using the quadagree package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using the quadagree package</h1>
            
      

      <div class="d-none name"><code>using_fleissci.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jonasmoss.github.io/quadagree/">quadagree</a></span><span class="op">)</span></span></code></pre></div>
<p>Use the <code>quadagree</code> package to estimate and do inference
on the quadratically weighted Fleiss’ kappa and Conger’s kappa (the
multirater variant of Cohen’s kappa). It supports data on two forms: Raw
or aggregated. An example of data on “raw” or “wide” form is the
following data set with 4 raters and 5 categories from Zapf et
al. (2016).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat.zapf2016</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Rater A</th>
<th align="right">Rater B</th>
<th align="right">Rater C</th>
<th align="right">Rater D</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">5</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>To calculate asymptotic confidence intervals for Fleiss’ kappa,
use</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quadagree.html">fleissci</a></span><span class="op">(</span><span class="va">dat.zapf2016</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: fleissci(x = dat.zapf2016)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% confidence interval (n = 50).</span></span>
<span><span class="co">#&gt;     0.025     0.975 </span></span>
<span><span class="co">#&gt; 0.8418042 0.9549730 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample estimates.</span></span>
<span><span class="co">#&gt;     kappa        sd </span></span>
<span><span class="co">#&gt; 0.8983886 0.1971016</span></span></code></pre></div>
<p>If you want to calculate Conger’s kappa (multi-rater Cohen’s kappa),
use</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quadagree.html">cohenci</a></span><span class="op">(</span><span class="va">dat.zapf2016</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: cohenci(x = dat.zapf2016)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% confidence interval (n = 50).</span></span>
<span><span class="co">#&gt;     0.025     0.975 </span></span>
<span><span class="co">#&gt; 0.8419597 0.9549804 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample estimates.</span></span>
<span><span class="co">#&gt;     kappa        sd </span></span>
<span><span class="co">#&gt; 0.8984700 0.1968438</span></span></code></pre></div>
<p>Finally, the quadratic Brennan-Prediger coefficient can be found
by</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quadagree.html">bpci</a></span><span class="op">(</span><span class="va">dat.zapf2016</span>, kind <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: bpci(x = dat.zapf2016, kind = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% confidence interval (n = 50).</span></span>
<span><span class="co">#&gt;     0.025     0.975 </span></span>
<span><span class="co">#&gt; 0.8026384 0.9323616 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample estimates.</span></span>
<span><span class="co">#&gt;     kappa        sd </span></span>
<span><span class="co">#&gt; 0.8675000 0.2259341</span></span></code></pre></div>
<p>Kind <code>1</code> returns the classical Brennan-Prediger
coefficients, while <code>2</code> returns the new formulation by Moss
(2023).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quadagree.html">bpci</a></span><span class="op">(</span><span class="va">dat.zapf2016</span>, kind <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: bpci(x = dat.zapf2016, kind = 2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% confidence interval (n = 50).</span></span>
<span><span class="co">#&gt;     0.025     0.975 </span></span>
<span><span class="co">#&gt; 0.9013192 0.9661808 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample estimates.</span></span>
<span><span class="co">#&gt;    kappa       sd </span></span>
<span><span class="co">#&gt; 0.933750 0.112967</span></span></code></pre></div>
<p>It is also possible to use the studentized bootstrap by selecting the
option <code>bootstrap = "TRUE</code>“, but this appears to confer no
benefits and we would recommend sticking to the standard methods.</p>
<p>The package supports several options for estimating the asymptotic
covariance matrix using the <code>type</code> argument. The
<code>adf</code> option makes no assumptions about the data-generating
process and is recommended. The <code>elliptical</code> option assumes
the rating data is elliptical, and the <code>normal</code> option that
it is normal. There are also a couple of transforms for the confidence
intervals; <code>none</code>, <code>fisher</code>, and
<code>arcsin</code>. The Fisher and arcsine transforms appear to work
slightly better in practice.</p>
<p>All examples in this vignette use categorical data, but the package
also supports continuous data, which is most meaningful for Fleiss’
kappa, Conger’s kappa, and the new Brennan-Prediger coefficient (i.e.,
with <code>kind = 2</code>).</p>
<p>This package supports missing data in the following sense: If the
same set of raters rate every item, but some raters are missing for some
of the rows. An example is the Klein (2018) data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dat.klein2018</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">rater1</th>
<th align="right">rater2</th>
<th align="right">rater3</th>
<th align="right">rater4</th>
<th align="right">rater5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Here missing data is marked as <code>N/A</code>. The estimators of
the coefficients are consistent, and the inference is based on pairwise
available data using the method of van Praag (1985)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quadagree.html">fleissci</a></span><span class="op">(</span><span class="va">dat.klein2018</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: fleissci(x = dat.klein2018)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% confidence interval (n = 10).</span></span>
<span><span class="co">#&gt;      0.025      0.975 </span></span>
<span><span class="co">#&gt; -0.1549052  0.6048678 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample estimates.</span></span>
<span><span class="co">#&gt;     kappa        sd </span></span>
<span><span class="co">#&gt; 0.2249813 0.5037932</span></span></code></pre></div>
<p>It’s not supported to do inference on data with less than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>
ratings per pair. The following data from Gwet (2014) is an example</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dat.gwet2014</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">rater1</th>
<th align="right">rater2</th>
<th align="right">rater3</th>
<th align="right">rater4</th>
<th align="right">rater5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Observe that only one row is rated by both rater 4 and 5. Hence you
get an error when calling</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quadagree.html">fleissci</a></span><span class="op">(</span><span class="va">dat.gwet2014</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in fun(calc): The data does not contain sufficient non-NAs.</span></span></code></pre></div>
<div class="section level2">
<h2 id="aggregated-data">Aggregated data<a class="anchor" aria-label="anchor" href="#aggregated-data"></a>
</h2>
<p>Data on aggregated form looks different, with each row aggregating
the number of ratings for each category. The following example is from
Fleiss (1971).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat.fleiss1971</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">depression</th>
<th align="right">personality disorder</th>
<th align="right">schizophrenia</th>
<th align="right">neurosis</th>
<th align="right">other</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The dataset has categories</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat.fleiss1971</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "depression"           "personality disorder" "schizophrenia"       </span></span>
<span><span class="co">#&gt; [4] "neurosis"             "other"</span></span></code></pre></div>
<p>Provided we understand <code>depression</code> as being
<code>1</code>, <code>personality disorder</code> as being
<code>2</code>, and so on, we can calculate and do inference on the
quadratically weighted Fleiss kappa (but not Conger’s kappa) for data on
this form.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quadagree.html">fleissci_aggr</a></span><span class="op">(</span><span class="va">dat.fleiss1971</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: fleissci_aggr(x = dat.fleiss1971)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% confidence interval (n = 30).</span></span>
<span><span class="co">#&gt;      0.025      0.975 </span></span>
<span><span class="co">#&gt; 0.05668483 0.51145967 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample estimates.</span></span>
<span><span class="co">#&gt; kappa.xtx        sd </span></span>
<span><span class="co">#&gt; 0.2840722 0.5987194</span></span></code></pre></div>
<p>The results from using the aggregated functions agree with
<code>irrCAC</code>, despite the underlying methodology being different.
The main contributions of this package when it comes to aggregated data
is the ability to calculate the new variant of the Brennan-Prediger
coefficient, the support for a a <code>values</code> telling the program
what value to attach to each rating, and the support for transforms. The
calculations are also marginally faster, about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>
times, but this is unlikely to have an impact. Note that inference for
missing data on aggregated form is not supported. Data on aggregated
form can, however, be bootstrapped, and the transforms
<code>none</code>, <code>fisher</code> and <code>arcsin</code> are
supported. The <code>type</code> options used in the long form do not
make sense in this context.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Moss.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
