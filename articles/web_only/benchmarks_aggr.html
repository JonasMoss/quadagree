<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="quadagree">
<title>Short benchmark of Fleiss' kappa and Brennan-Prediger • quadagree</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Short benchmark of Fleiss' kappa and Brennan-Prediger">
<meta property="og:description" content="quadagree">
<meta property="og:image" content="https://jonasmoss.github.io/quadagree/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">quadagree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/using_fleissci.html">Using the quadagree package</a>
    <a class="dropdown-item" href="../../articles/web_only/benchmarks_aggr.html">Short benchmark of Fleiss' kappa and Brennan-Prediger</a>
    <a class="dropdown-item" href="../../articles/web_only/benchmarks_long.html">Benchmark of Fleiss' kappa, Cohen's kappa, and the Brennan-Prediger coefficient</a>
    <a class="dropdown-item" href="../../articles/web_only/consistency.html">Consistency with missing ratings</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Short benchmark of Fleiss' kappa and Brennan-Prediger</h1>
            <h3 data-toc-skip class="subtitle">Benchmark for the
aggregated functions</h3>
                        <h4 data-toc-skip class="author">Jonas Moss</h4>
            
            <h4 data-toc-skip class="date">4/25/2023</h4>
      
      
      <div class="d-none name"><code>benchmarks_aggr.rmd</code></div>
    </div>

    
    
<p>The most feature complete <code>R</code> package for agreement
coefficients is <code>irrCAC</code>. It implements Fleiss’ kappa and the
Brennan-Prediger coefficient for both aggregated and long form data.
Despite the fact that their method of inference, based on <span class="math inline">\(U\)</span>-statistics, does not look the same as
ours (based on moments) they are equivalent in the case of aggregated
data. Compare the confidence intervals below to be convinced of
this.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://jonasmoss.github.io/quadagree/">"quadagree"</a></span><span class="op">)</span></span>
<span><span class="fu">irrCAC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/irrCAC/man/bp.coeff.dist.html" class="external-link">bp.coeff.dist</a></span><span class="op">(</span><span class="va">dat.fleiss1971</span>, weights <span class="op">=</span> <span class="st">"quadratic"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         coeff.name     coeff    stderr      conf.int     p.value        pa   pe</span></span>
<span><span class="co">## 1 Brennan-Prediger 0.3338889 0.1036175 (0.122,0.546) 0.003134299 0.8334722 0.75</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/quadagree.html">bpci_aggr</a></span><span class="op">(</span><span class="va">dat.fleiss1971</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Call: bpci_aggr(x = dat.fleiss1971)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 95% confidence interval (n = 30).</span></span>
<span><span class="co">##     0.025     0.975 </span></span>
<span><span class="co">## 0.1219674 0.5458104 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample estimates.</span></span>
<span><span class="co">##     kappa        sd </span></span>
<span><span class="co">## 0.3338889 0.5579971</span></span></code></pre>
<p>For aggregated data, <code>quadagree</code> supports user-supplied
<code>values</code> vectors, transforms, and studentized bootstrapping,
which <code>irrCAC</code> does not. But is it faster? It turns out it is
roughly twice as fast for reasonable numbers of raters. This suggests
there is no benefit in using the moment formulation (as done in
<code>quadagree</code>) when calculating these coefficients, as
<code>quadagree</code> is likely to be substantially more optimized than
<code>irrCAC</code>.</p>
<p>We note that no effort has been made to bin the values. One of the
benefits of the moment formulation of Fleiss’ kappa is its ability to
handle continuous values, and binning will not help here. It is,
however, possible to take advantage of binning when dealing with
categorical data, also in the moment formulation. Implementing binning
is likely to further increase the speed differential between
<code>irrCAC</code> and <code>quadagree</code>, especially when there
are few categories compared to the number of rows, but its utility is
questionable.</p>
<div class="section level2">
<h2 id="benchmarks">Benchmarks<a class="anchor" aria-label="anchor" href="#benchmarks"></a>
</h2>
<p>We will run three benchmarks of various sizes using the
<code>microbenchmark</code> package. We start off with
<code>dat.fleiss1971</code>, which contains <span class="math inline">\(n=30\)</span> rows.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">dat.fleiss1971</span></span>
<span><span class="va">irr_bp</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">irrCAC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/irrCAC/man/bp.coeff.dist.html" class="external-link">bp.coeff.dist</a></span><span class="op">(</span><span class="va">x</span>, weights <span class="op">=</span> <span class="st">"quadratic"</span><span class="op">)</span></span>
<span><span class="va">irr_fleiss</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">irrCAC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/irrCAC/man/fleiss.kappa.dist.html" class="external-link">fleiss.kappa.dist</a></span><span class="op">(</span><span class="va">x</span>, weights <span class="op">=</span> <span class="st">"quadratic"</span><span class="op">)</span></span>
<span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu">irr_bp</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../../reference/quadagree.html">bpci_aggr</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu">irr_fleiss</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../../reference/quadagree.html">fleissci_aggr</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: microseconds</span></span>
<span><span class="co">##              expr   min     lq     mean median     uq     max neval</span></span>
<span><span class="co">##         irr_bp(x) 706.9 736.50 788.2840 746.70 762.80  4061.3  1000</span></span>
<span><span class="co">##      bpci_aggr(x) 343.1 363.20 392.6745 399.70 410.30  3627.9  1000</span></span>
<span><span class="co">##     irr_fleiss(x) 731.6 756.85 835.9941 769.85 788.15 16578.5  1000</span></span>
<span><span class="co">##  fleissci_aggr(x) 333.6 354.60 386.9121 382.80 402.45  3571.8  1000</span></span></code></pre>
<p>So <code>quadagree</code> is roughly twice as fast. Let’s see what
happens when <span class="math inline">\(n=300\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">dat.fleiss1971</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu">irr_bp</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../../reference/quadagree.html">bpci_aggr</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu">irr_fleiss</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../../reference/quadagree.html">fleissci_aggr</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: microseconds</span></span>
<span><span class="co">##              expr   min     lq     mean median     uq    max neval</span></span>
<span><span class="co">##         irr_bp(x) 743.3 772.40 820.4821 789.10 813.75 4290.4  1000</span></span>
<span><span class="co">##      bpci_aggr(x) 353.0 383.15 424.3919 415.55 426.45 3946.7  1000</span></span>
<span><span class="co">##     irr_fleiss(x) 757.6 798.35 861.4403 817.20 842.70 7254.2  1000</span></span>
<span><span class="co">##  fleissci_aggr(x) 349.2 378.75 411.6448 408.90 420.80 3795.8  1000</span></span></code></pre>
<p>The run time is almost the same for all methods as it was for <span class="math inline">\(n=30\)</span>, suggesting that there is
substantial overhead to both methods. Let’s check <span class="math inline">\(n=3000\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="co"># x has 3000 elements.</span></span>
<span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu">irr_bp</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../../reference/quadagree.html">bpci_aggr</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu">irr_fleiss</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../../reference/quadagree.html">fleissci_aggr</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: microseconds</span></span>
<span><span class="co">##              expr    min      lq      mean  median      uq     max neval</span></span>
<span><span class="co">##         irr_bp(x) 1081.7 1126.20 1235.1523 1145.70 1195.15  7068.1  1000</span></span>
<span><span class="co">##      bpci_aggr(x)  494.9  520.05  572.0573  548.70  563.20  5069.3  1000</span></span>
<span><span class="co">##     irr_fleiss(x) 1124.8 1171.55 1363.1395 1195.05 1231.80 76225.3  1000</span></span>
<span><span class="co">##  fleissci_aggr(x)  522.7  551.25  608.8986  575.15  589.60  3931.4  1000</span></span></code></pre>
<p>It appears that <code>bpci_aggr</code> is pulling ahead of
<code><a href="https://rdrr.io/pkg/irrCAC/man/bp.coeff.dist.html" class="external-link">irrCAC::bp.coeff.dist</a></code>.</p>
<p>Let’s finish off with a larger number of categories.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="co"># x has 3000 elements and 50 categories.</span></span>
<span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu">irr_bp</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../../reference/quadagree.html">bpci_aggr</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu">irr_fleiss</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../../reference/quadagree.html">fleissci_aggr</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: milliseconds</span></span>
<span><span class="co">##              expr    min      lq     mean  median      uq     max neval</span></span>
<span><span class="co">##         irr_bp(x) 3.8453 4.65960 5.920814 4.77565 7.12095 80.4477  1000</span></span>
<span><span class="co">##      bpci_aggr(x) 1.1643 1.29110 1.453478 1.32080 1.35940  7.0062  1000</span></span>
<span><span class="co">##     irr_fleiss(x) 4.0651 4.78940 5.799846 4.93465 7.07835 79.9973  1000</span></span>
<span><span class="co">##  fleissci_aggr(x) 1.1637 1.31125 1.487462 1.33780 1.38115 10.5684  1000</span></span></code></pre>
<p>So <code>quadagree</code> could substantially faster on data with
very many categories and items rated.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jonas Moss.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
